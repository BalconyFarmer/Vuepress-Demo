<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>组件库指南 | Adroi媒体API 接口文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Adroi">
    
    <link rel="preload" href="/v1/adroi-h5/adroiapi/assets/css/0.styles.7774a11a.css" as="style"><link rel="preload" href="/v1/adroi-h5/adroiapi/assets/js/app.157a5a96.js" as="script"><link rel="preload" href="/v1/adroi-h5/adroiapi/assets/js/2.42df1874.js" as="script"><link rel="preload" href="/v1/adroi-h5/adroiapi/assets/js/8.01ce69dc.js" as="script"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/10.b517e4d5.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/11.f36bfc7f.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/12.1f137d0c.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/13.d87931d6.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/14.b26b449a.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/15.46f209bb.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/3.4a055781.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/4.2c7ea40e.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/5.36b4d7eb.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/6.f79a1d77.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/7.d853a457.js"><link rel="prefetch" href="/v1/adroi-h5/adroiapi/assets/js/9.198f7fce.js">
    <link rel="stylesheet" href="/v1/adroi-h5/adroiapi/assets/css/0.styles.7774a11a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/v1/adroi-h5/adroiapi/" class="home-link router-link-active"><!----> <span class="site-name">Adroi媒体API 接口文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/guide/" class="nav-link">
  前端文档
</a></div><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/component/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  组件库
</a></div><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/issues/" class="nav-link">
  问题库
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/guide/" class="nav-link">
  前端文档
</a></div><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/component/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  组件库
</a></div><div class="nav-item"><a href="/v1/adroi-h5/adroiapi/issues/" class="nav-link">
  问题库
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/v1/adroi-h5/adroiapi/component/" aria-current="page" class="active sidebar-link">组件库指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v1/adroi-h5/adroiapi/component/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/v1/adroi-h5/adroiapi/component/#规划目录结构" class="sidebar-link">规划目录结构</a></li><li class="sidebar-sub-header"><a href="/v1/adroi-h5/adroiapi/component/#创建一个新组件" class="sidebar-link">创建一个新组件</a></li><li class="sidebar-sub-header"><a href="/v1/adroi-h5/adroiapi/component/#编写示例" class="sidebar-link">编写示例</a></li><li class="sidebar-sub-header"><a href="/v1/adroi-h5/adroiapi/component/#打包" class="sidebar-link">打包</a></li><li class="sidebar-sub-header"><a href="/v1/adroi-h5/adroiapi/component/#使用方法" class="sidebar-link">使用方法</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="组件库指南"><a href="#组件库指南" class="header-anchor">#</a> 组件库指南</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <div class="custom-block tip"><p class="custom-block-title">前言</p> <p>为了解决项目搬来搬去修改重复bug的问题,把一些基本上不会动并且复用性特别高的页面封装成组件,以组件的形式在项目中调用,
然后把一些常用的小组件封装起来,还有统一的样式和iconfont都放到一块</p></div> <h2 id="规划目录结构"><a href="#规划目录结构" class="header-anchor">#</a> 规划目录结构</h2> <p>现在咱们需要一个<code>packages</code>存放组件,然后<code>example</code>存放示例</p> <p>现在先新建一个<code>packages</code>,然后把现有的<code>src</code>改成<code>example</code>,把项目改成这个结构之后会造成两个问题:</p> <ol><li><code>src</code>改成<code>example</code>之后项目跑不起来</li> <li>新增的<code>packages</code>,不会被<code>webpack</code>编译,所以需要添加配置对该目录的支持</li></ol> <p>需要把<code>vue.config.js</code>修改为如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 这是vue.config.js的部分配置,其他的配置不用动</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    pages<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> <span class="token punctuation">{</span>
            entry<span class="token operator">:</span> <span class="token string">&quot;example/main.js&quot;</span><span class="token punctuation">,</span>
            template<span class="token operator">:</span> <span class="token string">&quot;public/index.html&quot;</span><span class="token punctuation">,</span>
            filename<span class="token operator">:</span> <span class="token string">&quot;index.html&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        config<span class="token punctuation">.</span>module<span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&quot;js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>include<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;packages&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;babel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="创建一个新组件"><a href="#创建一个新组件" class="header-anchor">#</a> 创建一个新组件</h2> <p>上面我们配置好了新的目录结构</p> <div class="language-js extra-class"><pre class="language-js"><code>├─ <span class="token keyword">public</span>  <span class="token comment">/*这个里面放不需要编译的静态文件,可以用过/根目录来访问到*/</span>
└─ example
└─ packages
   ├─ api 
   ├─ assets <span class="token comment">/*静态文件目录*/</span>
   ├─ commonComponents <span class="token comment">/*公共组件目录*/</span>
   ├─ config
   │    └─ index<span class="token punctuation">.</span>js <span class="token comment">/*全局变量*/</span>
   ├─ libs 
   ├─ Plugins
      ├─ PartyOrgPortrait 
      └─ Zbgf 
        └─ src <span class="token comment">/*组件源码*/</span>
        └─ index<span class="token punctuation">.</span>js  <span class="token comment">/*对外提供对组件的引用*/</span>
      └─ idnex<span class="token punctuation">.</span>js <span class="token comment">/*整合所有的组件，对外导出，即一个完整的组件库*/</span>
   ├─ router
   ├─ store <span class="token comment">/*Vuex仓库,每个模块对应一个js*/</span>
   ├─ styles <span class="token comment">/*样式文件目录*/</span>
 ├─ <span class="token punctuation">.</span>env<span class="token punctuation">.</span>development <span class="token comment">/*开发环境的配置*/</span>
 └─ <span class="token punctuation">.</span>env<span class="token punctuation">.</span>production <span class="token comment">/*生产环境的配置*/</span>
 └─ <span class="token keyword">package</span><span class="token punctuation">.</span>json
 └─ vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js
</code></pre></div><p>首先先看下<code>packages/Plugins/Zbgf/index.js</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 导入组件，组件必须声明 name</span>
<span class="token keyword">import</span> Zbgfh <span class="token keyword">from</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> zbgfhAtlas <span class="token keyword">from</span> <span class="token string">&quot;./src/centerPart/org-atlas.vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 为组件提供 install 安装方法，供按需引入</span>
Zbgfh<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Zbgfh<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Zbgfh<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>zbgfhAtlas<span class="token punctuation">.</span>name<span class="token punctuation">,</span> zbgfhAtlas<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 默认导出组件</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> Zbgfh<span class="token punctuation">,</span> zbgfhAtlas <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><code>packages/Plugins/index.js</code>这个文件是整合这个页面里面所有的组件对外导出,比如支部规范化就有一个支规的页面和一个详情的弹窗,其他页面可能会有更多.</p> <div class="custom-block tip"><p class="custom-block-title">注意事项</p> <p>1.我们的页面是带有store的,在编写页面的store时,都要加上namespaced,防止和宿主项目的store冲突,Vuex会报混淆的错误</p> <p>2.导出的时候不仅要导出组件,还要导出install方法</p></div> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Zbgfh<span class="token punctuation">,</span> zbgfhAtlas <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./Zbgf&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// vuex的store文件</span>
<span class="token keyword">import</span> zbgfhstore <span class="token keyword">from</span> <span class="token string">&quot;../store/modules/zbgf&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;../echarts/echarts&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Zbgfh&quot;</span><span class="token punctuation">,</span> Zbgfh<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;zbgfhAtlas&quot;</span><span class="token punctuation">,</span> zbgfhAtlas<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">[</span>Zbgfh<span class="token punctuation">,</span> zbgfhAtlas<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 这一步判断window.Vue是否存在，因为直接引用vue.min.js， 它会把Vue绑到Window上，我们直接引用打包好的js才能正常跑起来。</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&quot;redrcd-zbgfh&quot;</span><span class="token punctuation">,</span> components<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// opts是用户传入的store</span>
<span class="token keyword">const</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>opts<span class="token punctuation">.</span>store<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Please provide a store!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 动态注册store</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>store<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        opts<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token string">&quot;zbgfh&quot;</span><span class="token punctuation">,</span> zbgfhstore<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
        components<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">component</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">install</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    install<span class="token punctuation">,</span>
    Zbgfh<span class="token punctuation">,</span>
    zbgfhAtlas
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="编写示例"><a href="#编写示例" class="header-anchor">#</a> 编写示例</h2> <p>在组件项目中测试就用这种方法,带上需要传的参数
<code>example/zbgfh.vue</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>height-full width-full<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>zbgf</span> <span class="token attr-name">:po-code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>poCode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:region-code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>regionCode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:po-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>poName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@zbgf-goto-hx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zbgfGotoHx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>zbgf</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> zbgfhh <span class="token keyword">from</span> <span class="token string">&quot;../packages/Plugins/Zbgf/src/index&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;zbgfh&quot;</span><span class="token punctuation">,</span>
    components<span class="token operator">:</span> <span class="token punctuation">{</span> zbgf<span class="token operator">:</span> zbgfhh <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            poCode<span class="token operator">:</span> <span class="token string">&quot;001.001.053&quot;</span><span class="token punctuation">,</span>
            regionCode<span class="token operator">:</span> <span class="token string">&quot;53&quot;</span><span class="token punctuation">,</span>
            poName<span class="token operator">:</span> <span class="token string">&quot;云南省&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">zbgfGotoHx</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h2 id="打包"><a href="#打包" class="header-anchor">#</a> 打包</h2> <p>在根目录下面的<code>package.json</code>中<code>scripts</code>下面新增一条lib</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service lint&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --target lib --name zbgfh packages/Plugins/index.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>在<code>vue cli</code>的官方文档中,我们可以找到打包库模式的方法.详细了解参考<a href="https://cli.vuejs.org/zh/guide/build-targets.html#%E6%9E%84%E5%BB%BA%E7%9B%AE%E6%A0%87" target="_blank" rel="noopener noreferrer">vue-cli 构建目标库方法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block tip"><p class="custom-block-title">注意对Vue的依赖</p> <p>在库模式中，<code>Vue</code> 是外置的。这意味着包中不会有 <code>Vue</code>，即便你在代码中导入了 <code>Vue</code>。如果这个库会通过一个打包器使用，它将尝试通过打包器以依赖的方式加载 <code>Vue</code>；否则就会回退到一个全局的 <code>Vue</code> 变量。</p></div> <p>你可以通过下面的命令将一个单独的入口构建为一个库：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>vue-cli-service build --target lib --name myLib <span class="token punctuation">[</span>entry<span class="token punctuation">]</span>
</code></pre></div><p>打包后的结构是这样的</p> <div class="language-shell extra-class"><pre class="language-shell"><code>File                     Size                     Gzipped

dist/myLib.umd.min.js    <span class="token number">13.28</span> kb                 <span class="token number">8.42</span> kb
dist/myLib.umd.js        <span class="token number">20.95</span> kb                 <span class="token number">10.22</span> kb
dist/myLib.common.js     <span class="token number">20.57</span> kb                 <span class="token number">10.09</span> kb
dist/myLib.css           <span class="token number">0.33</span> kb                  <span class="token number">0.23</span> kb
</code></pre></div><p>这个入口可以是一个 .js 或一个 .vue 文件。如果没有指定入口，则会使用 src/App.vue。
构建一个库会输出：</p> <ul><li><code>dist/myLib.common.js</code>: 一个给打包器用的 CommonJS 包 (不幸的是，webpack 目前还并没有支持 ES modules 输出格式的包)</li> <li><code>dist/myLib.umd.js</code>: 一个直接给浏览器或 AMD loader 使用的 UMD 包</li> <li><code>dist/myLib.umd.min.js</code>: 压缩后的 UMD 构建版本</li> <li><code>dist/myLib.css</code>: 提取出来的 CSS 文件 (可以通过在 vue.config.js 中设置 css: { extract: false } 强制内联)</li></ul> <div class="custom-block tip"><p class="custom-block-title">什么是UMD</p> <p><code>commonJS</code>、<code>requireJS</code> 都是用来处理JS模块化的，其中 <code>commonJS</code> 用来给 <code>nodejs</code> 使用（使用了 <code>module.exports</code> 的用法）。后来使用 <code>import/export</code> 来导出/引入模块。<code>umd</code> 是统一模块定义方法，可以兼容所有其他的模块定义方法。</p></div> <p>到这为止, 要么就是打包上传的<code>npm</code>上面,要么直接把<code>umd</code>文件引入到项目当中去,因为考虑到上传到<code>npm</code>,需要创建<code>npm</code>私服,因为数据请求也封装在里面了,不能直接放到互联网上
;第二就是每次有改动的时候宿主项目都需要手动去<code>npm install</code> 最新的版本才能使用, 对于已经上线了的项目很不方便,因为我们后续的改动几率还挺大的.
所以先暂时把打包后的js放到党建云上,其他项目直接调用这个script标签就行了.</p> <h2 id="使用方法"><a href="#使用方法" class="header-anchor">#</a> 使用方法</h2> <p>以支部规范化为例子</p> <div class="custom-block warning"><p class="custom-block-title">提示</p> <ul><li>每个宿主项目的高德地图key可能都不一样,宿主项目需要引入高德地图(我们的项目基本上都有),然后由于mapStyle是和key一一对应的,所以有地图的组件mapStyle都需要传进去</li> <li>因为有一些项目是https域名的,所以统一打包放到服务器上都需要做https的映射,现在先统一放到<code>10.10.3.79</code>上<code>/data/apache/commoncomponents</code>上面.</li> <li>组件的名字在IDE里面会报错找不到,这个不用管,<code>console.log(zbgfh)</code>能打印出来就行.</li></ul></div> <ul><li>第一步在<code>public/index.html</code>里面引入<code>umd</code>的js</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;https://sj.bigdata.1237125.cn/commoncomponents/zbgfh/zbgfh.umd.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ul><li>第二步,如果组件里面有store,那需要在在<code>main.js</code>里面把组件的store注册到项目的store上面</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>zbgfh<span class="token punctuation">.</span>default<span class="token punctuation">,</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>第三步,把组件引入到页面中去</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zbgf-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>zbgfh</span>
        <span class="token attr-name">:po-code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>poCode<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:region-code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>regionCode<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:po-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>poName<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:token</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>token<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:mapStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapStyle<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:background-image</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>backgroundImage<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">@zbgf-goto-hx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zbgfGotoHx<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>zbgfh</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> zbgfh<span class="token operator">:</span> zbgfh<span class="token punctuation">.</span>default<span class="token punctuation">.</span>Zbgfh <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      dyhxShow<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      poCode<span class="token operator">:</span> <span class="token string">&quot;001.001.053&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 传入的poCode,看不同地方的数据</span>
      isHasChildren<span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 有没有下级, 1代表有下级, 0代表没有下级, 是支部</span>
      regionCode<span class="token operator">:</span> <span class="token string">&quot;53&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 传入的regionCode, 一般用做画地图的轮廓和处理数据</span>
      poName<span class="token operator">:</span> <span class="token string">&quot;云南省&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 根组织的名称</span>
      mapStyle<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 每个项目自己的mapStyle</span>
      token<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 预留的token,等统一的用户中心做起来之后token再用</span>
      backgroundImage<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../../assets/images/container-bg.jpg&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 每个项目的背景图片不一样, 这里需要传入该项目的背景图片</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">zbgfGotoHx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// TODO 去党组织画像</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.zbgf-box</span> <span class="token punctuation">{</span> <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> 
  <span class="token comment">/*TODO 这里可以改一些局部的样式*/</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/v1/adroi-h5/adroiapi/assets/js/app.157a5a96.js" defer></script><script src="/v1/adroi-h5/adroiapi/assets/js/2.42df1874.js" defer></script><script src="/v1/adroi-h5/adroiapi/assets/js/8.01ce69dc.js" defer></script>
  </body>
</html>
